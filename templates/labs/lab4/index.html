{% extends 'base.html' %}
{% load static %}

{% block title %}{{ title }}{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/–õ–†4/–õ–†4.css' %}">
{% endblock %}

{% block content %}
<h2>{{ title }}</h2>

<!-- –í–∫–ª–∞–¥–∫–∏ -->
<div class="tabs">
    <button class="tab-btn active" data-tab="keys-tab">–ì–µ–Ω–µ—Ä–∞—Ü—ñ—è –∫–ª—é—á—ñ–≤</button>
    <button class="tab-btn" data-tab="encrypt-tab">–®–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è</button>
    <button class="tab-btn" data-tab="decrypt-tab">–î–µ—à–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è</button>
</div>

<!-- –í–∫–ª–∞–¥–∫–∞ 1: –ì–µ–Ω–µ—Ä–∞—Ü—ñ—è –∫–ª—é—á—ñ–≤ -->
<div id="keys-tab" class="tab-content active">
    <div class="card">
        <h3 class="section-title">–ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –≥–µ–Ω–µ—Ä–∞—Ü—ñ—ó</h3>
        <div class="grid">
            <div class="form-group">
                <label>–†–æ–∑–º—ñ—Ä –∫–ª—é—á–∞ (–±—ñ—Ç):</label>
                <select id="key-size" class="form-control">
                    <option value="1024">1024 (–®–≤–∏–¥–∫–æ, –º–µ–Ω—à –Ω–∞–¥—ñ–π–Ω–æ)</option>
                    <option value="2048" selected>2048 (–°—Ç–∞–Ω–¥–∞—Ä—Ç)</option>
                    <option value="3072">3072 (–í–∏—Å–æ–∫–∞ –Ω–∞–¥—ñ–π–Ω—ñ—Å—Ç—å)</option>
                    <option value="4096">4096 (–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞ –Ω–∞–¥—ñ–π–Ω—ñ—Å—Ç—å)</option>
                </select>
            </div>
            <div class="form-group">
                <label>–ü–∞—Ä–æ–ª—å –¥–ª—è –ø—Ä–∏–≤–∞—Ç–Ω–æ–≥–æ –∫–ª—é—á–∞ (–æ–ø—Ü—ñ–æ–Ω–∞–ª—å–Ω–æ):</label>
                <input type="password" id="key-password" class="form-control" placeholder="–ó–∞–ª–∏—à—Ç–µ –ø—É—Å—Ç–∏–º, —è–∫—â–æ –±–µ–∑ –ø–∞—Ä–æ–ª—è">
            </div>
        </div>
        <button class="btn btn-primary" onclick="generateKeys()">–ó–≥–µ–Ω–µ—Ä—É–≤–∞—Ç–∏ –ø–∞—Ä—É –∫–ª—é—á—ñ–≤</button>

        <div id="keys-result" class="key-display-area" style="display: none;">
            <div class="key-box">
                <div class="key-header">
                    <span class="key-title">üî¥ –ü—Ä–∏–≤–∞—Ç–Ω–∏–π –∫–ª—é—á (Private Key)</span>
                    <div class="button-group-sm">
                        <button class="btn btn-sm" onclick="copyText('private-key-display')">–ö–æ–ø—ñ—é–≤–∞—Ç–∏</button>
                        <button class="btn btn-sm btn-success" onclick="downloadKey('private')">–ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ .pem</button>
                    </div>
                </div>
                <textarea id="private-key-display" class="key-content" readonly></textarea>
                <p class="text-sm text-danger mt-1">* –ù—ñ–∫–æ–º—É –Ω–µ –ø–µ—Ä–µ–¥–∞–≤–∞–π—Ç–µ —Ü–µ–π –∫–ª—é—á!</p>
            </div>

            <div class="key-box">
                <div class="key-header">
                    <span class="key-title">üü¢ –ü—É–±–ª—ñ—á–Ω–∏–π –∫–ª—é—á (Public Key)</span>
                    <div class="button-group-sm">
                        <button class="btn btn-sm" onclick="copyText('public-key-display')">–ö–æ–ø—ñ—é–≤–∞—Ç–∏</button>
                        <button class="btn btn-sm btn-success" onclick="downloadKey('public')">–ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ .pem</button>
                    </div>
                </div>
                <textarea id="public-key-display" class="key-content" readonly></textarea>
                <p class="text-sm text-muted mt-1">* –¶–µ–π –∫–ª—é—á –º–æ–∂–Ω–∞ –≤—ñ–ª—å–Ω–æ –ø–æ—à–∏—Ä—é–≤–∞—Ç–∏.</p>
            </div>
        </div>
    </div>
</div>

<!-- –í–∫–ª–∞–¥–∫–∞ 2: –®–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è -->
<div id="encrypt-tab" class="tab-content">
    <div class="card">
        <h3 class="section-title">1. –î–∞–Ω—ñ –¥–ª—è —à–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è</h3>
        
        <div class="file-upload-area" id="encrypt-file-zone">
            <input type="file" id="encrypt-file" class="file-input">
            <div class="upload-content">
                <p>üìÇ –ü–µ—Ä–µ—Ç—è–≥–Ω—ñ—Ç—å —Ñ–∞–π–ª —Å—é–¥–∏ –∞–±–æ –∫–ª—ñ–∫–Ω—ñ—Ç—å –¥–ª—è –≤–∏–±–æ—Ä—É</p>
                <span id="encrypt-filename" class="text-primary font-bold"></span>
            </div>
        </div>
        
        <div class="separator">–ê–ë–û</div>
        
        <div class="form-group">
            <label>–í–≤–µ–¥—ñ—Ç—å —Ç–µ–∫—Å—Ç:</label>
            <textarea id="encrypt-text" class="form-control" rows="3" placeholder="–°–µ–∫—Ä–µ—Ç–Ω–µ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è..."></textarea>
        </div>

        <h3 class="section-title mt-4">2. –ü—É–±–ª—ñ—á–Ω–∏–π –∫–ª—é—á –æ—Ç—Ä–∏–º—É–≤–∞—á–∞</h3>
        <div class="tabs-sm mb-2">
            <label><input type="radio" name="enc-key-source" value="text" checked onclick="toggleKeyInput('enc', 'text')"> –í—Å—Ç–∞–≤–∏—Ç–∏ —Ç–µ–∫—Å—Ç</label>
            <label class="ml-4"><input type="radio" name="enc-key-source" value="file" onclick="toggleKeyInput('enc', 'file')"> –ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ —Ñ–∞–π–ª</label>
        </div>

        <div id="enc-key-text-container">
            <textarea id="encrypt-pub-key" class="form-control key-input" rows="4" placeholder="-----BEGIN PUBLIC KEY-----..."></textarea>
        </div>
        <div id="enc-key-file-container" style="display: none;">
            <input type="file" id="encrypt-pub-key-file" class="form-control">
        </div>

        <button class="btn btn-primary mt-4" onclick="encryptData()">üîí –ó–∞—à–∏—Ñ—Ä—É–≤–∞—Ç–∏</button>

        <div id="encrypt-result" class="result-box" style="display: none;">
            <div class="result-header">‚úÖ –£—Å–ø—ñ—à–Ω–æ –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–æ!</div>
            <div class="info-grid">
                <div class="info-item"><label>–í—Ö—ñ–¥–Ω–∏–π —Ä–æ–∑–º—ñ—Ä:</label><span id="enc-orig-size"></span></div>
                <div class="info-item"><label>–†–æ–∑–º—ñ—Ä —à–∏—Ñ—Ä–æ—Ç–µ–∫—Å—Ç—É:</label><span id="enc-res-size"></span></div>
                <div class="info-item"><label>–ß–∞—Å:</label><span id="enc-time"></span></div>
            </div>
            <div class="form-group">
                <label>HEX –ø—Ä–µ–≤'—é:</label>
                <div id="enc-hex-preview" class="key-content" style="height: 60px; overflow-y: hidden; text-overflow: ellipsis;"></div>
            </div>
            <button class="btn btn-success" id="btn-download-enc">üì• –ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–π —Ñ–∞–π–ª (.enc)</button>
        </div>
    </div>
</div>

<!-- –í–∫–ª–∞–¥–∫–∞ 3: –î–µ—à–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è -->
<div id="decrypt-tab" class="tab-content">
    <div class="card">
        <h3 class="section-title">1. –ó–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω—ñ –¥–∞–Ω—ñ</h3>
        
        <div class="file-upload-area" id="decrypt-file-zone">
            <input type="file" id="decrypt-file" class="file-input">
            <div class="upload-content">
                <p>üìÇ –ü–µ—Ä–µ—Ç—è–≥–Ω—ñ—Ç—å .enc —Ñ–∞–π–ª —Å—é–¥–∏ –∞–±–æ –∫–ª—ñ–∫–Ω—ñ—Ç—å</p>
                <span id="decrypt-filename" class="text-primary font-bold"></span>
            </div>
        </div>
        
        <div class="separator">–ê–ë–û</div>
        
        <div class="form-group">
            <label>–í—Å—Ç–∞–≤—Ç–µ HEX —Ä—è–¥–æ–∫:</label>
            <textarea id="decrypt-hex" class="form-control" rows="3" placeholder="A1B2C3..."></textarea>
        </div>

        <h3 class="section-title mt-4">2. –í–∞—à –ü—Ä–∏–≤–∞—Ç–Ω–∏–π –∫–ª—é—á</h3>
        <div class="tabs-sm mb-2">
            <label><input type="radio" name="dec-key-source" value="text" checked onclick="toggleKeyInput('dec', 'text')"> –í—Å—Ç–∞–≤–∏—Ç–∏ —Ç–µ–∫—Å—Ç</label>
            <label class="ml-4"><input type="radio" name="dec-key-source" value="file" onclick="toggleKeyInput('dec', 'file')"> –ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ —Ñ–∞–π–ª</label>
        </div>

        <div id="dec-key-text-container">
            <textarea id="decrypt-priv-key" class="form-control key-input" rows="4" placeholder="-----BEGIN ENCRYPTED PRIVATE KEY-----..."></textarea>
        </div>
        <div id="dec-key-file-container" style="display: none;">
            <input type="file" id="decrypt-priv-key-file" class="form-control">
        </div>

        <div class="form-group mt-3">
            <label>–ü–∞—Ä–æ–ª—å –∫–ª—é—á–∞ (—è–∫—â–æ —î):</label>
            <input type="password" id="decrypt-key-pass" class="form-control" placeholder="–ü–∞—Ä–æ–ª—å –ø—Ä–∏–≤–∞—Ç–Ω–æ–≥–æ –∫–ª—é—á–∞">
        </div>

        <button class="btn btn-primary mt-4" onclick="decryptData()">üîì –î–µ—à–∏—Ñ—Ä—É–≤–∞—Ç–∏</button>

        <div id="decrypt-result" class="result-box" style="display: none;">
            <div class="result-header">‚úÖ –£—Å–ø—ñ—à–Ω–æ –¥–µ—à–∏—Ñ—Ä–æ–≤–∞–Ω–æ!</div>
            <div class="info-grid">
                <div class="info-item"><label>–†–æ–∑–º—ñ—Ä –¥–∞–Ω–∏—Ö:</label><span id="dec-res-size"></span></div>
                <div class="info-item"><label>–ß–∞—Å:</label><span id="dec-time"></span></div>
                <div class="info-item"><label>–¢–∏–ø –¥–∞–Ω–∏—Ö:</label><span id="dec-type"></span></div>
            </div>
            
            <div class="form-group" id="dec-text-preview-group">
                <label>–†–æ–∑—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–π —Ç–µ–∫—Å—Ç:</label>
                <textarea id="dec-text-preview" class="form-control" rows="4" readonly></textarea>
            </div>
            
            <button class="btn btn-success" id="btn-download-dec">üì• –ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ —Ñ–∞–π–ª</button>
        </div>
    </div>
</div>

<!-- Loader -->
<div id="loader" class="loader" style="display: none;"></div>

{% endblock %}

{% block extra_js %}
<script src="{% static 'js/–õ–†4/lr4_JS.js' %}"></script>
{% endblock %}